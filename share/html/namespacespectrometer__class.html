<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NonAdMD: spectrometer_class Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.gif"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NonAdMD
   &#160;<span id="projectnumber">0.1.41</span>
   </div>
   <div id="projectbrief">alpha-stable</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacespectrometer__class.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">spectrometer_class Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Spectrometric functionality.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacespectrometer__class_1_1check.html">check</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that checks the spectrum type.  <a href="interfacespectrometer__class_1_1check.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacespectrometer__class_1_1display.html">display</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Display the spectrum type.  <a href="interfacespectrometer__class_1_1display.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacespectrometer__class_1_1kill.html">kill</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys the spectrum type.  <a href="interfacespectrometer__class_1_1kill.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacespectrometer__class_1_1observe.html">observe</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measures the Hamiltonian.  <a href="interfacespectrometer__class_1_1observe.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structspectrometer__class_1_1spectrum.html">spectrum</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard spectrum type.  <a href="structspectrometer__class_1_1spectrum.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a068171434fa75613677e6357291df1fe"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespectrometer__class.html#a068171434fa75613677e6357291df1fe">get_spectrum</a> (this, qs, cs, cp, Emin, Emax, npt, type, tol, samples, file, pdb, psf, psfx, atm_select, dipole_to, dipole_from, dipole_center)</td></tr>
<tr class="memdesc:a068171434fa75613677e6357291df1fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">General call to compute verious spectra.  <a href="#a068171434fa75613677e6357291df1fe">More...</a><br /></td></tr>
<tr class="separator:a068171434fa75613677e6357291df1fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabaa46560b8ea49cd16b6c11a8a2fe65"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespectrometer__class.html#aabaa46560b8ea49cd16b6c11a8a2fe65">spectrum_kill</a> (this)</td></tr>
<tr class="memdesc:aabaa46560b8ea49cd16b6c11a8a2fe65"><td class="mdescLeft">&#160;</td><td class="mdescRight">nullifies spectrum pointer  <a href="#aabaa46560b8ea49cd16b6c11a8a2fe65">More...</a><br /></td></tr>
<tr class="separator:aabaa46560b8ea49cd16b6c11a8a2fe65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94382eb7e533e6a74dd79200ca0e38ed"><td class="memItemLeft" align="right" valign="top">integer(short) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespectrometer__class.html#a94382eb7e533e6a74dd79200ca0e38ed">spectrum_check</a> (this)</td></tr>
<tr class="memdesc:a94382eb7e533e6a74dd79200ca0e38ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks spectrum type  <a href="#a94382eb7e533e6a74dd79200ca0e38ed">More...</a><br /></td></tr>
<tr class="separator:a94382eb7e533e6a74dd79200ca0e38ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f9fc6096d581c5a7094174b47898d10"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespectrometer__class.html#a3f9fc6096d581c5a7094174b47898d10">display_spectrum</a> (this)</td></tr>
<tr class="separator:a3f9fc6096d581c5a7094174b47898d10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2c4936524c8702e1c4e53a54a043f31"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespectrometer__class.html#ad2c4936524c8702e1c4e53a54a043f31">get_abspectrum</a> (this, qs, cs, cp, tol, samples, file)</td></tr>
<tr class="memdesc:ad2c4936524c8702e1c4e53a54a043f31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes absorption spectrum using groundstate to adiabatic state transition dipole.  <a href="#ad2c4936524c8702e1c4e53a54a043f31">More...</a><br /></td></tr>
<tr class="separator:ad2c4936524c8702e1c4e53a54a043f31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1fc802879075c7e5e42ef4baac69445"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespectrometer__class.html#af1fc802879075c7e5e42ef4baac69445">get_abpdbspectrum</a> (this, qs, file, pdb, psf, psfx, atm_select, dipole_to, dipole_from, dipole_center)</td></tr>
<tr class="memdesc:af1fc802879075c7e5e42ef4baac69445"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes Absorption spectrum using a pdb trajectory and a defined transition dipole.  <a href="#af1fc802879075c7e5e42ef4baac69445">More...</a><br /></td></tr>
<tr class="separator:af1fc802879075c7e5e42ef4baac69445"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5564f6a94902c50fefd03dd3f5ec4e47"><td class="memItemLeft" align="right" valign="top">integer(long), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespectrometer__class.html#a5564f6a94902c50fefd03dd3f5ec4e47">killint</a></td></tr>
<tr class="memdesc:a5564f6a94902c50fefd03dd3f5ec4e47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Machine limit of integer values. Used to exit out of non-converging loops.  <a href="#a5564f6a94902c50fefd03dd3f5ec4e47">More...</a><br /></td></tr>
<tr class="separator:a5564f6a94902c50fefd03dd3f5ec4e47"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Spectrometric functionality. </p>
<p>A spectrum type is defined here. The spectrum type is the standard output of the associated methods with perform various spectrocopic mesurements of the total Hamiltonian or subsystems. </p><dl class="section author"><dt>Author</dt><dd>Daniel Montemayor </dd></dl>
<dl class="section date"><dt>Date</dt><dd>May 2011 </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a3f9fc6096d581c5a7094174b47898d10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f9fc6096d581c5a7094174b47898d10">&#9670;&nbsp;</a></span>display_spectrum()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spectrometer_class::display_spectrum </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structspectrometer__class_1_1spectrum.html">spectrum</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af1fc802879075c7e5e42ef4baac69445"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1fc802879075c7e5e42ef4baac69445">&#9670;&nbsp;</a></span>get_abpdbspectrum()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spectrometer_class::get_abpdbspectrum </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structspectrometer__class_1_1spectrum.html">spectrum</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structquantum__class_1_1quantum.html">quantum</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>qs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*(*), intent(in)&#160;</td>
          <td class="paramname"><em>pdb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*(*), intent(in)&#160;</td>
          <td class="paramname"><em>psf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*(*), intent(in)&#160;</td>
          <td class="paramname"><em>psfx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmolreader_1_1atom.html">atom</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>atm_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmolreader_1_1atom.html">atom</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dipole_to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmolreader_1_1atom.html">atom</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dipole_from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmolreader_1_1atom.html">atom</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dipole_center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes Absorption spectrum using a pdb trajectory and a defined transition dipole. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespectrometer__class_af1fc802879075c7e5e42ef4baac69445_icgraph.png" border="0" usemap="#namespacespectrometer__class_af1fc802879075c7e5e42ef4baac69445_icgraph" alt=""/></div>
<map name="namespacespectrometer__class_af1fc802879075c7e5e42ef4baac69445_icgraph" id="namespacespectrometer__class_af1fc802879075c7e5e42ef4baac69445_icgraph">
<area shape="rect" id="node3" href="namespacespectrometer__class.html#a068171434fa75613677e6357291df1fe" title="General call to compute verious spectra. " alt="" coords="201,5,338,49"/>
</map>
</div>

</div>
</div>
<a id="ad2c4936524c8702e1c4e53a54a043f31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2c4936524c8702e1c4e53a54a043f31">&#9670;&nbsp;</a></span>get_abspectrum()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spectrometer_class::get_abspectrum </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structspectrometer__class_1_1spectrum.html">spectrum</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structquantum__class_1_1quantum.html">quantum</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>qs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structclassical__class_1_1classical.html">classical</a>), intent(inout), optional&#160;</td>
          <td class="paramname"><em>cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcoupling__class_1_1coupling.html">coupling</a>), intent(inout), optional&#160;</td>
          <td class="paramname"><em>cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(double), intent(in), optional&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(long), intent(in), optional&#160;</td>
          <td class="paramname"><em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes absorption spectrum using groundstate to adiabatic state transition dipole. </p>
<p>Requires a quantum subsystem described in terms of transistion dipole moments. N points in spectrum with energy domain from Emin to Emax. Integrate over thermal realizations to compute spectrum. Recompute spectrum with twice as many thermal realizations. Keep doubling number of realizations until sum of difference in spectrum to previous spectrum points squared is less than some tolerance tol. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>spectrum type, it is overwritten with the spectroscopic measurement on return. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qs</td><td>general quantum subsystem to be measured. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cs</td><td>general classical subsystem to be measured. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cp</td><td>general coupling term to be measured. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">samples</td><td>minimum number of measurements to make before convergance protocols take effect. Guarantees good statistics. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>\( R^2 \) difference between successive measurements. Used to determine spectrum convergance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">file</td><td>name of file to output spectrum on return. </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000005">Todo:</a></b></dt><dd><ul>
<li>Add method to check if quantum subsystem is supported.</li>
<li>Rewrite details section and add brief comment. </li>
</ul>
</dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespectrometer__class_ad2c4936524c8702e1c4e53a54a043f31_cgraph.png" border="0" usemap="#namespacespectrometer__class_ad2c4936524c8702e1c4e53a54a043f31_cgraph" alt=""/></div>
<map name="namespacespectrometer__class_ad2c4936524c8702e1c4e53a54a043f31_cgraph" id="namespacespectrometer__class_ad2c4936524c8702e1c4e53a54a043f31_cgraph">
<area shape="rect" id="node3" href="subroutines_8f90.html#a50a3911748dbb5647bf6be5043e905e1" title="diagonalize" alt="" coords="220,5,308,33"/>
<area shape="rect" id="node5" href="namespacefilemanager.html#aa389048ef7c9eb9afdac7ce1dcc691b2" title="filemanager::newunit" alt="" coords="192,57,336,85"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespectrometer__class_ad2c4936524c8702e1c4e53a54a043f31_icgraph.png" border="0" usemap="#namespacespectrometer__class_ad2c4936524c8702e1c4e53a54a043f31_icgraph" alt=""/></div>
<map name="namespacespectrometer__class_ad2c4936524c8702e1c4e53a54a043f31_icgraph" id="namespacespectrometer__class_ad2c4936524c8702e1c4e53a54a043f31_icgraph">
<area shape="rect" id="node3" href="namespacespectrometer__class.html#a068171434fa75613677e6357291df1fe" title="General call to compute verious spectra. " alt="" coords="193,5,330,49"/>
</map>
</div>

</div>
</div>
<a id="a068171434fa75613677e6357291df1fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a068171434fa75613677e6357291df1fe">&#9670;&nbsp;</a></span>get_spectrum()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spectrometer_class::get_spectrum </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structspectrometer__class_1_1spectrum.html">spectrum</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structquantum__class_1_1quantum.html">quantum</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>qs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structclassical__class_1_1classical.html">classical</a>), intent(inout), optional, target&#160;</td>
          <td class="paramname"><em>cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structcoupling__class_1_1coupling.html">coupling</a>), intent(inout), optional, target&#160;</td>
          <td class="paramname"><em>cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(double), intent(in)&#160;</td>
          <td class="paramname"><em>Emin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(double), intent(in)&#160;</td>
          <td class="paramname"><em>Emax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(long), intent(in)&#160;</td>
          <td class="paramname"><em>npt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(double), intent(in), optional&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(long), intent(in), optional&#160;</td>
          <td class="paramname"><em>samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>pdb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>psf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>psfx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmolreader_1_1atom.html">atom</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>atm_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmolreader_1_1atom.html">atom</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>dipole_to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmolreader_1_1atom.html">atom</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>dipole_from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmolreader_1_1atom.html">atom</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>dipole_center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>General call to compute verious spectra. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>spectrum type, it is overwritten with the spectroscopic measurement on return. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qs</td><td>general quantum subsystem to be measured. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cs</td><td>general classical subsystem to be measured. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cp</td><td>general coupling term to be measured. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npt</td><td>number of points in the frequency domain. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Emin</td><td>minimum value of frequncy domain. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Emax</td><td>maximum value of the frequency domain. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>string containing the type of the spectroscopic measurement. Options are 'AB' and 'ABPDB'. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">samples</td><td>minimum number of measurements to make before convergance protocols take effect. Guarantees good statistics. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>\( R^2 \) difference between successive measurements. Used to determine spectrum convergance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">file</td><td>name of file to output spectrum on return. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pdb</td><td>name of input pdb file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">psf</td><td>name of input psf file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">psfx</td><td>name of psf file containing excited state charges. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm_select</td><td>atom type used to determine a subset of atoms. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dipole_to</td><td>atom type specifing direction a dipole points to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dipole_from</td><td>atom type specifing direction a dipole points from. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dipole_center</td><td>atom type specifing the origin of a dipole. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacespectrometer__class_a068171434fa75613677e6357291df1fe_cgraph.png" border="0" usemap="#namespacespectrometer__class_a068171434fa75613677e6357291df1fe_cgraph" alt=""/></div>
<map name="namespacespectrometer__class_a068171434fa75613677e6357291df1fe_cgraph" id="namespacespectrometer__class_a068171434fa75613677e6357291df1fe_cgraph">
<area shape="rect" id="node3" href="namespacespectrometer__class.html#ad2c4936524c8702e1c4e53a54a043f31" title="Computes absorption spectrum using groundstate to adiabatic state transition dipole. " alt="" coords="197,22,334,66"/>
<area shape="rect" id="node9" href="namespacespectrometer__class.html#af1fc802879075c7e5e42ef4baac69445" title="Computes Absorption spectrum using a pdb trajectory and a defined transition dipole. " alt="" coords="192,90,339,134"/>
<area shape="rect" id="node5" href="subroutines_8f90.html#a50a3911748dbb5647bf6be5043e905e1" title="diagonalize" alt="" coords="414,5,503,33"/>
<area shape="rect" id="node7" href="namespacefilemanager.html#aa389048ef7c9eb9afdac7ce1dcc691b2" title="filemanager::newunit" alt="" coords="386,57,531,85"/>
</map>
</div>

</div>
</div>
<a id="a94382eb7e533e6a74dd79200ca0e38ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94382eb7e533e6a74dd79200ca0e38ed">&#9670;&nbsp;</a></span>spectrum_check()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(short) function spectrometer_class::spectrum_check </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structspectrometer__class_1_1spectrum.html">spectrum</a>), intent(in)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks spectrum type </p>

</div>
</div>
<a id="aabaa46560b8ea49cd16b6c11a8a2fe65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabaa46560b8ea49cd16b6c11a8a2fe65">&#9670;&nbsp;</a></span>spectrum_kill()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine spectrometer_class::spectrum_kill </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structspectrometer__class_1_1spectrum.html">spectrum</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>nullifies spectrum pointer </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>spectrum type </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a5564f6a94902c50fefd03dd3f5ec4e47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5564f6a94902c50fefd03dd3f5ec4e47">&#9670;&nbsp;</a></span>killint</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(long), parameter spectrometer_class::killint</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Machine limit of integer values. Used to exit out of non-converging loops. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacespectrometer__class.html">spectrometer_class</a></li>
    <li class="footer">Generated on Tue Apr 18 2017 10:18:15 for NonAdMD by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
